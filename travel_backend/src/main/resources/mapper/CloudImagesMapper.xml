<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.travel_backend.mapper.CloudImagesMapper">

    <select id="getAllImages" resultType="com.example.travel_backend.data.CloudImagesDTO">
        SELECT content_id, firstimage, firstimage2, firstimage3, firstimage4, firstimage5
        FROM destination
    </select>

    <select id="getFailedImages" resultType="com.example.travel_backend.data.CloudImagesDTO">
        SELECT content_id, firstimage, firstimage2, firstimage3, firstimage4, firstimage5
        FROM destination
        WHERE firstimage LIKE '%/' OR firstimage2 LIKE '%/' OR firstimage3 LIKE '%/' OR firstimage4 LIKE '%/' OR firstimage5 LIKE '%/';
    </select>

    <select id="getBackupImagesByIds" resultType="com.example.travel_backend.data.CloudImagesDTO" parameterType="java.util.List">
        SELECT content_id, firstimage, firstimage2, firstimage3, firstimage4, firstimage5
        FROM current_images
        WHERE content_id IN
        <foreach item="contentId" collection="list" open="(" separator="," close=")">
            #{contentId}
        </foreach>
    </select>

    <update id="updateImageUrls">
        UPDATE destination
        SET firstimage = #{firstimage},
            firstimage2 = #{firstimage2},
            firstimage3 = #{firstimage3},
            firstimage4 = #{firstimage4},
            firstimage5 = #{firstimage5}
        WHERE content_id = #{contentId}
    </update>
</mapper>